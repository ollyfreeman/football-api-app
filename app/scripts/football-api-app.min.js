!function(expose){function mk_block_toSource(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function mk_block_inspect(){var util=require("util");return"Markdown.mk_block( "+util.inspect(this.toString())+", "+util.inspect(this.trailing)+", "+util.inspect(this.lineNumber)+" )"}function count_lines(str){for(var n=0,i=-1;-1!==(i=str.indexOf("\n",i+1));)n++;return n}function strong_em(tag,md){function CloseTag(len){this.len_after=len,this.name="close_"+md}var state_slot=tag+"_state",other_slot="strong"==tag?"em_state":"strong_state";return function(text,orig_match){if(this[state_slot][0]==md)return this[state_slot].shift(),[text.length,new CloseTag(text.length-md.length)];var other=this[other_slot].slice(),state=this[state_slot].slice();this[state_slot].unshift(md);var res=this.processInline(text.substr(md.length)),last=res[res.length-1];this[state_slot].shift();if(last instanceof CloseTag){res.pop();var consumed=text.length-last.len_after;return[consumed,[tag].concat(res)]}return this[other_slot]=other,this[state_slot]=state,[md.length,md]}}function split_meta_hash(meta_string){for(var meta=meta_string.split(""),parts=[""],in_quotes=!1;meta.length;){var letter=meta.shift();switch(letter){case" ":in_quotes?parts[parts.length-1]+=letter:parts.push("");break;case"'":case'"':in_quotes=!in_quotes;break;case"\\":letter=meta.shift();default:parts[parts.length-1]+=letter}}return parts}function extract_attr(jsonml){return isArray(jsonml)&&jsonml.length>1&&"object"==typeof jsonml[1]&&!isArray(jsonml[1])?jsonml[1]:void 0}function escapeHTML(text){return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function render_tree(jsonml){if("string"==typeof jsonml)return escapeHTML(jsonml);var tag=jsonml.shift(),attributes={},content=[];for(!jsonml.length||"object"!=typeof jsonml[0]||jsonml[0]instanceof Array||(attributes=jsonml.shift());jsonml.length;)content.push(render_tree(jsonml.shift()));var tag_attrs="";for(var a in attributes)tag_attrs+=" "+a+'="'+escapeHTML(attributes[a])+'"';return"img"==tag||"br"==tag||"hr"==tag?"<"+tag+tag_attrs+"/>":"<"+tag+tag_attrs+">"+content.join("")+"</"+tag+">"}function convert_tree_to_html(tree,references,options){var i;options=options||{};var jsonml=tree.slice(0);"function"==typeof options.preprocessTreeNode&&(jsonml=options.preprocessTreeNode(jsonml,references));var attrs=extract_attr(jsonml);if(attrs){jsonml[1]={};for(i in attrs)jsonml[1][i]=attrs[i];attrs=jsonml[1]}if("string"==typeof jsonml)return jsonml;switch(jsonml[0]){case"header":jsonml[0]="h"+jsonml[1].level,delete jsonml[1].level;break;case"bulletlist":jsonml[0]="ul";break;case"numberlist":jsonml[0]="ol";break;case"listitem":jsonml[0]="li";break;case"para":jsonml[0]="p";break;case"markdown":jsonml[0]="html",attrs&&delete attrs.references;break;case"code_block":jsonml[0]="pre",i=attrs?2:1;var code=["code"];code.push.apply(code,jsonml.splice(i,jsonml.length-i)),jsonml[i]=code;break;case"inlinecode":jsonml[0]="code";break;case"img":jsonml[1].src=jsonml[1].href,delete jsonml[1].href;break;case"linebreak":jsonml[0]="br";break;case"link":jsonml[0]="a";break;case"link_ref":jsonml[0]="a";var ref=references[attrs.ref];if(!ref)return attrs.original;delete attrs.ref,attrs.href=ref.href,ref.title&&(attrs.title=ref.title),delete attrs.original;break;case"img_ref":jsonml[0]="img";var ref=references[attrs.ref];if(!ref)return attrs.original;delete attrs.ref,attrs.src=ref.href,ref.title&&(attrs.title=ref.title),delete attrs.original}if(i=1,attrs){for(var key in jsonml[1]){i=2;break}1===i&&jsonml.splice(i,1)}for(;i<jsonml.length;++i)jsonml[i]=convert_tree_to_html(jsonml[i],references,options);return jsonml}function merge_text_nodes(jsonml){for(var i=extract_attr(jsonml)?2:1;i<jsonml.length;)"string"==typeof jsonml[i]?i+1<jsonml.length&&"string"==typeof jsonml[i+1]?jsonml[i]+=jsonml.splice(i+1,1)[0]:++i:(merge_text_nodes(jsonml[i]),++i)}var Markdown=expose.Markdown=function(dialect){switch(typeof dialect){case"undefined":this.dialect=Markdown.dialects.Gruber;break;case"object":this.dialect=dialect;break;default:if(!(dialect in Markdown.dialects))throw new Error("Unknown Markdown dialect '"+String(dialect)+"'");this.dialect=Markdown.dialects[dialect]}this.em_state=[],this.strong_state=[],this.debug_indent=""};expose.parse=function(source,dialect){var md=new Markdown(dialect);return md.toTree(source)},expose.toHTML=function(source,dialect,options){var input=expose.toHTMLTree(source,dialect,options);return expose.renderJsonML(input)},expose.toHTMLTree=function(input,dialect,options){"string"==typeof input&&(input=this.parse(input,dialect));var attrs=extract_attr(input),refs={};attrs&&attrs.references&&(refs=attrs.references);var html=convert_tree_to_html(input,refs,options);return merge_text_nodes(html),html};var mk_block=Markdown.mk_block=function(block,trail,line){1==arguments.length&&(trail="\n\n");var s=new String(block);return s.trailing=trail,s.inspect=mk_block_inspect,s.toSource=mk_block_toSource,void 0!=line&&(s.lineNumber=line),s};Markdown.prototype.split_blocks=function(input,startLine){input=input.replace(/(\r\n|\n|\r)/g,"\n");var m,re=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,blocks=[],line_no=1;for(null!=(m=/^(\s*\n)/.exec(input))&&(line_no+=count_lines(m[0]),re.lastIndex=m[0].length);null!==(m=re.exec(input));)"\n#"==m[2]&&(m[2]="\n",re.lastIndex--),blocks.push(mk_block(m[1],m[2],line_no)),line_no+=count_lines(m[0]);return blocks},Markdown.prototype.processBlock=function(block,next){var cbs=this.dialect.block,ord=cbs.__order__;if("__call__"in cbs)return cbs.__call__.call(this,block,next);for(var i=0;i<ord.length;i++){var res=cbs[ord[i]].call(this,block,next);if(res)return(!isArray(res)||res.length>0&&!isArray(res[0]))&&this.debug(ord[i],"didn't return a proper array"),res}return[]},Markdown.prototype.processInline=function(block){return this.dialect.inline.__call__.call(this,String(block))},Markdown.prototype.toTree=function(source,custom_root){var blocks=source instanceof Array?source:this.split_blocks(source),old_tree=this.tree;try{for(this.tree=custom_root||this.tree||["markdown"];blocks.length;){var b=this.processBlock(blocks.shift(),blocks);b.length&&this.tree.push.apply(this.tree,b)}return this.tree}finally{custom_root&&(this.tree=old_tree)}},Markdown.prototype.debug=function(){var args=Array.prototype.slice.call(arguments);args.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,args),"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log.apply(null,args)},Markdown.prototype.loop_re_over_block=function(re,block,cb){for(var m,b=block.valueOf();b.length&&null!=(m=re.exec(b));)b=b.substr(m[0].length),cb.call(this,m);return b},Markdown.dialects={},Markdown.dialects.Gruber={block:{atxHeader:function(block,next){var m=block.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!m)return void 0;var header=["header",{level:m[1].length}];return Array.prototype.push.apply(header,this.processInline(m[2])),m[0].length<block.length&&next.unshift(mk_block(block.substr(m[0].length),block.trailing,block.lineNumber+2)),[header]},setextHeader:function(block,next){var m=block.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!m)return void 0;var level="="===m[2]?1:2,header=["header",{level:level},m[1]];return m[0].length<block.length&&next.unshift(mk_block(block.substr(m[0].length),block.trailing,block.lineNumber+2)),[header]},code:function(block,next){var ret=[],re=/^(?: {0,3}\t| {4})(.*)\n?/;if(!block.match(re))return void 0;block_search:for(;;){var b=this.loop_re_over_block(re,block.valueOf(),function(m){ret.push(m[1])});if(b.length){next.unshift(mk_block(b,block.trailing));break block_search}if(!next.length)break block_search;if(!next[0].match(re))break block_search;ret.push(block.trailing.replace(/[^\n]/g,"").substring(2)),block=next.shift()}return[["code_block",ret.join("\n")]]},horizRule:function(block,next){var m=block.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!m)return void 0;var jsonml=[["hr"]];return m[1]&&jsonml.unshift.apply(jsonml,this.processBlock(m[1],[])),m[3]&&next.unshift(mk_block(m[3])),jsonml},lists:function(){function regex_for_depth(depth){return new RegExp("(?:^("+indent_re+"{0,"+depth+"} {0,3})("+any_list+")\\s+)|(^"+indent_re+"{0,"+(depth-1)+"}[ ]{0,4})")}function expand_tab(input){return input.replace(/ {0,3}\t/g,"    ")}function add(li,loose,inline,nl){if(loose)return void li.push(["para"].concat(inline));var add_to=li[li.length-1]instanceof Array&&"para"==li[li.length-1][0]?li[li.length-1]:li;nl&&li.length>1&&inline.unshift(nl);for(var i=0;i<inline.length;i++){var what=inline[i],is_str="string"==typeof what;is_str&&add_to.length>1&&"string"==typeof add_to[add_to.length-1]?add_to[add_to.length-1]+=what:add_to.push(what)}}function get_contained_blocks(depth,blocks){for(var re=new RegExp("^("+indent_re+"{"+depth+"}.*?\\n?)*$"),replace=new RegExp("^"+indent_re+"{"+depth+"}","gm"),ret=[];blocks.length>0&&re.exec(blocks[0]);){var b=blocks.shift(),x=b.replace(replace,"");ret.push(mk_block(x,b.trailing,b.lineNumber))}return ret}function paragraphify(s,i,stack){var list=s.list,last_li=list[list.length-1];if(!(last_li[1]instanceof Array&&"para"==last_li[1][0]))if(i+1==stack.length)last_li.push(["para"].concat(last_li.splice(1,last_li.length-1)));else{var sublist=last_li.pop();last_li.push(["para"].concat(last_li.splice(1,last_li.length-1)),sublist)}}var any_list="[*+-]|\\d+\\.",bullet_list=/[*+-]/,is_list_re=new RegExp("^( {0,3})("+any_list+")[ 	]+"),indent_re="(?: {0,3}\\t| {4})";return function(block,next){function make_list(m){var list=bullet_list.exec(m[2])?["bulletlist"]:["numberlist"];return stack.push({list:list,indent:m[1]}),list}var m=block.match(is_list_re);if(!m)return void 0;for(var last_li,i,stack=[],list=make_list(m),loose=!1,ret=[stack[0].list];;){for(var lines=block.split(/(?=\n)/),li_accumulate="",line_no=0;line_no<lines.length;line_no++){var nl="",l=lines[line_no].replace(/^\n/,function(n){return nl=n,""}),line_re=regex_for_depth(stack.length);if(m=l.match(line_re),void 0!==m[1]){li_accumulate.length&&(add(last_li,loose,this.processInline(li_accumulate),nl),loose=!1,li_accumulate=""),m[1]=expand_tab(m[1]);var wanted_depth=Math.floor(m[1].length/4)+1;if(wanted_depth>stack.length)list=make_list(m),last_li.push(list),last_li=list[1]=["listitem"];else{var found=!1;for(i=0;i<stack.length;i++)if(stack[i].indent==m[1]){list=stack[i].list,stack.splice(i+1,stack.length-(i+1)),found=!0;break}found||(wanted_depth++,wanted_depth<=stack.length?(stack.splice(wanted_depth,stack.length-wanted_depth),list=stack[wanted_depth-1].list):(list=make_list(m),last_li.push(list))),last_li=["listitem"],list.push(last_li)}nl=""}l.length>m[0].length&&(li_accumulate+=nl+l.substr(m[0].length))}li_accumulate.length&&(add(last_li,loose,this.processInline(li_accumulate),nl),loose=!1,li_accumulate="");var contained=get_contained_blocks(stack.length,next);contained.length>0&&(forEach(stack,paragraphify,this),last_li.push.apply(last_li,this.toTree(contained,[])));var next_block=next[0]&&next[0].valueOf()||"";if(!next_block.match(is_list_re)&&!next_block.match(/^ /))break;block=next.shift();var hr=this.dialect.block.horizRule(block,next);if(hr){ret.push.apply(ret,hr);break}forEach(stack,paragraphify,this),loose=!0}return ret}}(),blockquote:function(block,next){if(!block.match(/^>/m))return void 0;var jsonml=[];if(">"!=block[0]){for(var lines=block.split(/\n/),prev=[],line_no=block.lineNumber;lines.length&&">"!=lines[0][0];)prev.push(lines.shift()),line_no++;var abutting=mk_block(prev.join("\n"),"\n",block.lineNumber);jsonml.push.apply(jsonml,this.processBlock(abutting,[])),block=mk_block(lines.join("\n"),block.trailing,line_no)}for(;next.length&&">"==next[0][0];){var b=next.shift();block=mk_block(block+block.trailing+b,b.trailing,block.lineNumber)}var input=block.replace(/^> ?/gm,""),processedBlock=(this.tree,this.toTree(input,["blockquote"])),attr=extract_attr(processedBlock);return attr&&attr.references&&(delete attr.references,isEmpty(attr)&&processedBlock.splice(1,1)),jsonml.push(processedBlock),jsonml},referenceDefn:function(block,next){var re=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!block.match(re))return void 0;extract_attr(this.tree)||this.tree.splice(1,0,{});var attrs=extract_attr(this.tree);void 0===attrs.references&&(attrs.references={});var b=this.loop_re_over_block(re,block,function(m){m[2]&&"<"==m[2][0]&&">"==m[2][m[2].length-1]&&(m[2]=m[2].substring(1,m[2].length-1));var ref=attrs.references[m[1].toLowerCase()]={href:m[2]};void 0!==m[4]?ref.title=m[4]:void 0!==m[5]&&(ref.title=m[5])});return b.length&&next.unshift(mk_block(b,block.trailing)),[]},para:function(block,next){return[["para"].concat(this.processInline(block))]}}},Markdown.dialects.Gruber.inline={__oneElement__:function(text,patterns_or_re,previous_nodes){var m,res;patterns_or_re=patterns_or_re||this.dialect.inline.__patterns__;var re=new RegExp("([\\s\\S]*?)("+(patterns_or_re.source||patterns_or_re)+")");if(m=re.exec(text),!m)return[text.length,text];if(m[1])return[m[1].length,m[1]];var res;return m[2]in this.dialect.inline&&(res=this.dialect.inline[m[2]].call(this,text.substr(m.index),m,previous_nodes||[])),res=res||[m[2].length,m[2]]},__call__:function(text,patterns){function add(x){"string"==typeof x&&"string"==typeof out[out.length-1]?out[out.length-1]+=x:out.push(x)}for(var res,out=[];text.length>0;)res=this.dialect.inline.__oneElement__.call(this,text,patterns,out),text=text.substr(res.shift()),forEach(res,add);return out},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(text){return this.dialect.inline.__escape__.exec(text)?[2,text.charAt(1)]:[1,"\\"]},"![":function(text){var m=text.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(m){m[2]&&"<"==m[2][0]&&">"==m[2][m[2].length-1]&&(m[2]=m[2].substring(1,m[2].length-1)),m[2]=this.dialect.inline.__call__.call(this,m[2],/\\/)[0];var attrs={alt:m[1],href:m[2]||""};return void 0!==m[4]&&(attrs.title=m[4]),[m[0].length,["img",attrs]]}return m=text.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),m?[m[0].length,["img_ref",{alt:m[1],ref:m[2].toLowerCase(),original:m[0]}]]:[2,"!["]},"[":function link(text){var orig=String(text),res=Markdown.DialectHelpers.inline_until_char.call(this,text.substr(1),"]");if(!res)return[1,"["];var link,attrs,consumed=1+res[0],children=res[1];text=text.substr(consumed);var m=text.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(m){var url=m[1];if(consumed+=m[0].length,url&&"<"==url[0]&&">"==url[url.length-1]&&(url=url.substring(1,url.length-1)),!m[3])for(var open_parens=1,len=0;len<url.length;len++)switch(url[len]){case"(":open_parens++;break;case")":0==--open_parens&&(consumed-=url.length-len,url=url.substring(0,len))}return url=this.dialect.inline.__call__.call(this,url,/\\/)[0],attrs={href:url||""},void 0!==m[3]&&(attrs.title=m[3]),link=["link",attrs].concat(children),[consumed,link]}return m=text.match(/^\s*\[(.*?)\]/),m?(consumed+=m[0].length,attrs={ref:(m[1]||String(children)).toLowerCase(),original:orig.substr(0,consumed)},link=["link_ref",attrs].concat(children),[consumed,link]):1==children.length&&"string"==typeof children[0]?(attrs={ref:children[0].toLowerCase(),original:orig.substr(0,consumed)},link=["link_ref",attrs,children[0]],[consumed,link]):[1,"["]},"<":function(text){var m;return null!=(m=text.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?m[3]?[m[0].length,["link",{href:"mailto:"+m[3]},m[3]]]:"mailto"==m[2]?[m[0].length,["link",{href:m[1]},m[1].substr("mailto:".length)]]:[m[0].length,["link",{href:m[1]},m[1]]]:[1,"<"]},"`":function(text){var m=text.match(/(`+)(([\s\S]*?)\1)/);return m&&m[2]?[m[1].length+m[2].length,["inlinecode",m[3]]]:[1,"`"]},"  \n":function(text){return[3,["linebreak"]]}},Markdown.dialects.Gruber.inline["**"]=strong_em("strong","**"),Markdown.dialects.Gruber.inline.__=strong_em("strong","__"),Markdown.dialects.Gruber.inline["*"]=strong_em("em","*"),Markdown.dialects.Gruber.inline._=strong_em("em","_"),Markdown.buildBlockOrder=function(d){var ord=[];for(var i in d)"__order__"!=i&&"__call__"!=i&&ord.push(i);d.__order__=ord},Markdown.buildInlinePatterns=function(d){var patterns=[];for(var i in d)if(!i.match(/^__.*__$/)){var l=i.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");patterns.push(1==i.length?l:"(?:"+l+")")}patterns=patterns.join("|"),d.__patterns__=patterns;var fn=d.__call__;d.__call__=function(text,pattern){return void 0!=pattern?fn.call(this,text,pattern):fn.call(this,text,patterns)}},Markdown.DialectHelpers={},Markdown.DialectHelpers.inline_until_char=function(text,want){for(var consumed=0,nodes=[];;){if(text.charAt(consumed)==want)return consumed++,[consumed,nodes];if(consumed>=text.length)return null;var res=this.dialect.inline.__oneElement__.call(this,text.substr(consumed));consumed+=res[0],nodes.push.apply(nodes,res.slice(1))}},Markdown.subclassDialect=function(d){function Block(){}function Inline(){}return Block.prototype=d.block,Inline.prototype=d.inline,{block:new Block,inline:new Inline}},Markdown.buildBlockOrder(Markdown.dialects.Gruber.block),Markdown.buildInlinePatterns(Markdown.dialects.Gruber.inline),Markdown.dialects.Maruku=Markdown.subclassDialect(Markdown.dialects.Gruber),Markdown.dialects.Maruku.processMetaHash=function(meta_string){for(var meta=split_meta_hash(meta_string),attr={},i=0;i<meta.length;++i)if(/^#/.test(meta[i]))attr.id=meta[i].substring(1);else if(/^\./.test(meta[i]))attr["class"]?attr["class"]=attr["class"]+meta[i].replace(/./," "):attr["class"]=meta[i].substring(1);else if(/\=/.test(meta[i])){var s=meta[i].split(/\=/);attr[s[0]]=s[1]}return attr},Markdown.dialects.Maruku.block.document_meta=function(block,next){if(block.lineNumber>1)return void 0;if(!block.match(/^(?:\w+:.*\n)*\w+:.*$/))return void 0;extract_attr(this.tree)||this.tree.splice(1,0,{});var pairs=block.split(/\n/);for(p in pairs){var m=pairs[p].match(/(\w+):\s*(.*)$/),key=m[1].toLowerCase(),value=m[2];this.tree[1][key]=value}return[]},Markdown.dialects.Maruku.block.block_meta=function(block,next){var m=block.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!m)return void 0;var hash,attr=this.dialect.processMetaHash(m[2]);if(""===m[1]){var node=this.tree[this.tree.length-1];if(hash=extract_attr(node),"string"==typeof node)return void 0;hash||(hash={},node.splice(1,0,hash));for(a in attr)hash[a]=attr[a];return[]}var b=block.replace(/\n.*$/,""),result=this.processBlock(b,[]);hash=extract_attr(result[0]),hash||(hash={},result[0].splice(1,0,hash));for(a in attr)hash[a]=attr[a];return result},Markdown.dialects.Maruku.block.definition_list=function(block,next){var i,m,tight=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,list=["dl"];if(!(m=block.match(tight)))return void 0;for(var blocks=[block];next.length&&tight.exec(next[0]);)blocks.push(next.shift());for(var b=0;b<blocks.length;++b){var m=blocks[b].match(tight),terms=m[1].replace(/\n$/,"").split(/\n/),defns=m[2].split(/\n:\s+/);for(i=0;i<terms.length;++i)list.push(["dt",terms[i]]);for(i=0;i<defns.length;++i)list.push(["dd"].concat(this.processInline(defns[i].replace(/(\n)\s+/,"$1"))))}return[list]},Markdown.dialects.Maruku.block.table=function table(block,next){var i,m,_split_on_unescaped=function(s,ch){ch=ch||"\\s",ch.match(/^[\\|\[\]{}?*.+^$]$/)&&(ch="\\"+ch);for(var m,res=[],r=new RegExp("^((?:\\\\.|[^\\\\"+ch+"])*)"+ch+"(.*)");m=s.match(r);)res.push(m[1]),s=m[2];return res.push(s),res},leading_pipe=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,no_leading_pipe=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/;if(m=block.match(leading_pipe))m[3]=m[3].replace(/^\s*\|/gm,"");else if(!(m=block.match(no_leading_pipe)))return void 0;var table=["table",["thead",["tr"]],["tbody"]];m[2]=m[2].replace(/\|\s*$/,"").split("|");var html_attrs=[];for(forEach(m[2],function(s){s.match(/^\s*-+:\s*$/)?html_attrs.push({align:"right"}):s.match(/^\s*:-+\s*$/)?html_attrs.push({align:"left"}):s.match(/^\s*:-+:\s*$/)?html_attrs.push({align:"center"}):html_attrs.push({})}),m[1]=_split_on_unescaped(m[1].replace(/\|\s*$/,""),"|"),i=0;i<m[1].length;i++)table[1][1].push(["th",html_attrs[i]||{}].concat(this.processInline(m[1][i].trim())));return forEach(m[3].replace(/\|\s*$/gm,"").split("\n"),function(row){var html_row=["tr"];for(row=_split_on_unescaped(row,"|"),i=0;i<row.length;i++)html_row.push(["td",html_attrs[i]||{}].concat(this.processInline(row[i].trim())));table[2].push(html_row)},this),[table]},Markdown.dialects.Maruku.inline["{:"]=function(text,matches,out){if(!out.length)return[2,"{:"];var before=out[out.length-1];if("string"==typeof before)return[2,"{:"];var m=text.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!m)return[2,"{:"];var meta=this.dialect.processMetaHash(m[1]),attr=extract_attr(before);attr||(attr={},before.splice(1,0,attr));for(var k in meta)attr[k]=meta[k];return[m[0].length,""]},Markdown.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,Markdown.buildBlockOrder(Markdown.dialects.Maruku.block),Markdown.buildInlinePatterns(Markdown.dialects.Maruku.inline);var forEach,isArray=Array.isArray||function(obj){return"[object Array]"==Object.prototype.toString.call(obj)};forEach=Array.prototype.forEach?function(arr,cb,thisp){return arr.forEach(cb,thisp)}:function(arr,cb,thisp){for(var i=0;i<arr.length;i++)cb.call(thisp||arr,arr[i],i,arr)};var isEmpty=function(obj){for(var key in obj)if(hasOwnProperty.call(obj,key))return!1;return!0};expose.renderJsonML=function(jsonml,options){options=options||{},options.root=options.root||!1;var content=[];if(options.root)content.push(render_tree(jsonml));else for(jsonml.shift(),!jsonml.length||"object"!=typeof jsonml[0]||jsonml[0]instanceof Array||jsonml.shift();jsonml.length;)content.push(render_tree(jsonml.shift()));return content.join("\n\n")}}(function(){return"undefined"==typeof exports?(window.markdown={},window.markdown):exports}()),function(){angular.module("footballAPI",["chart.js","ngMaterial","ngSanitize"]).config(["ChartJsProvider",function(ChartJsProvider){ChartJsProvider.setOptions({colours:["#3F51B5","#FF4081"],responsive:!1,showTooltips:!1,scaleOverride:!0,scaleSteps:5,scaleStepWidth:20,scaleStartValue:0,scaleLabel:" <%=value%>"}),ChartJsProvider.setOptions("Line",{pointDot:!1,bezierCurve:!1})}])}.call(this),function(){angular.module("footballAPI").constant("BUTTON",{PRE_START:"GETTING MATCH INFORMATION",START:"START",FINISHED:"GAME FINISHED",ERROR_START:"UNABLE TO FETCH MATCH INFORMATION - TRY LATER",ERROR_GAME:"SIMULATION CANCELLED - UNABLE TO FETCH MATCH INFORMATION"}).constant("CONFIG",{MATCH_SPEED:60}).constant("DATA",{HOME_WIN:"home win",DRAW:"draw",AWAY_WIN:"away win",HOME_TEAM:"localteam",AWAY_TEAM:"visitorteam",HT_SCORE:"match_ht_score",HT_SCORE_NOT_REACHED:"",FT_SCORE:"match_ft_score",FT_SCORE_NOT_REACHED:"",MATCH_STATUS:"match_status",MATCH_STATUS_HT:"HT",MATCH_STATUS_FT:"FT",MATCH_TIMER:"match_timer",MATCH_TIMER_FINISHED:"",EVENTS:"match_events",EVENT_PLAYER:"event_player",EVENT_TYPE:"event_type",EVENT_TYPE_GOAL:"goal",EVENT_TIME:"event_minute",EVENT_TEAM:"event_team",EVENT_RESULT:"event_result"}).constant("GRAPH",{LABEL_GAP:5}).constant("TIME",{INITAL_TIME:-1,FIRSTHALF_START:0,FIRSTHALF_END:45,HALFTIME_START:46,HALFTIME_END:60,SECONDHALF_START:61,SECONDHALF_END:106,SIXTY_SECONDS:6e4}).constant("URL",{GET_INITIAL_MATCH_INFO:"http://104.236.187.56/api/?Action=matches",START_SIMULATON_PREFIX:"http://104.236.187.56/api/?Action=start&matchspeed=",GET_SIMULATON_UPDATE_PREFIX:"http://104.236.187.56/api/?Action=today&tokenId=",GITHUB_API:"https://github.com/ollyfreeman/football-api-mock",GITHUB_API_README:"http://api.github.com/repos/ollyfreeman/football-api-mock/readme",GITHUB_APP:"https://github.com/ollyfreeman/football-api-app",LINKEDIN:"https://www.linkedin.com/profile/view?id=217892821",FOOTBALL_API:"http://www.football-api.com"})}.call(this),function(){angular.module("footballAPI").controller("ApiTabContentController",["$http","$sce","URL",function($http,$sce,URL){var ctrl;return ctrl=this,ctrl.content="Loading...",ctrl.footballApiURL=URL.FOOTBALL_API,ctrl.githubApiURL=URL.GITHUB_API,$http.get(URL.GITHUB_API_README).success(function(data,status){var content;return content=atob(data.content),content=markdown.toHTML(content),ctrl.content=$sce.trustAsHtml(content)}).error(function(data,status){return ctrl.content="Error loading README"}),ctrl}])}.call(this),function(){angular.module("footballAPI").controller("GameBarDisplayController",["Labels","GlobalEvents","Prediction","$scope",function(Labels,GlobalEvents,Prediction,$scope){var ctrl;return ctrl=this,ctrl.barTitle=$scope.description,"Predictions"===ctrl.barTitle?ctrl.tooltips=Prediction.predictionTooltips.list:ctrl.tooltips=GlobalEvents.eventTooltips.list,ctrl.tooltipLabels=Labels.tooltipLabels,ctrl}])}.call(this),function(){angular.module("footballAPI").controller("GameController",["Data","GlobalEvents","Graph","Labels","PlayerScore","Prediction","$interval","BUTTON","CONFIG","TIME",function(Data,GlobalEvents,Graph,Labels,PlayerScore,Prediction,$interval,BUTTON,CONFIG,TIME){var ctrl,finishSimulation,getTimeLabel,newInterval;return ctrl=this,ctrl.simulationTime=0,ctrl.matchSpeed=CONFIG.MATCH_SPEED,ctrl.simulationReady=!1,ctrl.buttonText=BUTTON.PRE_START,ctrl.matches=Data.matches,ctrl.predictions=Prediction.predictions,Data.initialise().then(function(){return Prediction.initialise(),GlobalEvents.initialise(),PlayerScore.initialise(),Graph.initialise(),ctrl.simulationReady=!0,ctrl.buttonText=BUTTON.START},function(){return ctrl.simulationReady=!1,ctrl.buttonText=BUTTON.ERROR_START}),ctrl.startSimulation=function(){var lengthOfSimulatedMinute;return lengthOfSimulatedMinute=TIME.SIXTY_SECONDS/ctrl.matchSpeed,Data.startMatch(ctrl.matchSpeed).then(function(){var intervalId;return ctrl.simulationReady=!1,ctrl.buttonText=getTimeLabel(ctrl.simulationTime),intervalId=newInterval(lengthOfSimulatedMinute,function(){return ctrl.simulationTime>=TIME.SECONDHALF_END&&finishSimulation(intervalId),Data.formatCurrentResults(ctrl.simulationTime),Prediction.recordPrediction(ctrl.simulationTime),GlobalEvents.addEventTooltip(ctrl.simulationTime),PlayerScore.calculatePlayerScore(ctrl.simulationTime),ctrl.simulationTime+=1,ctrl.buttonText=getTimeLabel(ctrl.simulationTime)})},function(){return ctrl.simulationReady=!1,ctrl.buttonText=BUTTON.ERROR_GAME})},ctrl.changePrediction=function(prediction,matchIndex){return Prediction.changePrediction(prediction,Data.matches[matchIndex].home_team,Data.matches[matchIndex].away_team,ctrl.simulationTime,matchIndex)},newInterval=function(interval,callback){return $interval(callback,interval)},finishSimulation=function(intervalId){return ctrl.simulationReady=!1,ctrl.buttonText=BUTTON.FINISHED,$interval.cancel(intervalId)},getTimeLabel=function(time){var half,mins,ref;return ref=Labels.tooltipLabels[time].split(" "),mins=ref[0],half=ref[1],half="FH"===half?"First Half ('FH')":"SH"===half?"Second Half ('SH')":"Half Time ('HT')",mins+" mins, "+half},ctrl}])}.call(this),function(){angular.module("footballAPI").controller("GraphController",["Graph",function(Graph){var ctrl;return ctrl=this,ctrl.data=Graph.data,ctrl.labels=Graph.labels,ctrl}])}.call(this),function(){angular.module("footballAPI").controller("HeaderController",["URL",function(URL){var ctrl;return ctrl=this,ctrl.githubURL=URL.GITHUB_APP,ctrl.linkedInURL=URL.LINKEDIN,ctrl}])}.call(this),function(){angular.module("footballAPI").controller("RulesTabContentController",["URL",function(URL){var ctrl;return ctrl=this,ctrl.footballApiURL=URL.FOOTBALL_API,ctrl}])}.call(this),function(){angular.module("footballAPI").directive("apiTabContent",function(){return{restrict:"E",replace:!1,templateUrl:"./app/templates/api-tab-content-template.html",controller:"ApiTabContentController",controllerAs:"apiTabCtrl"}})}.call(this),function(){angular.module("footballAPI").directive("appFooter",function(){return{restrict:"E",replace:!0,templateUrl:"./app/templates/footer-template.html"}})}.call(this),function(){angular.module("footballAPI").directive("gameBarDisplay",["Labels","GlobalEvents",function(Labels,GlobalEvents){return{restrict:"E",templateUrl:"./app/templates/game-bar-display-template.html",scope:{description:"@"},controller:"GameBarDisplayController",controllerAs:"gameBarDisplayCtrl"}}])}.call(this),function(){angular.module("footballAPI").directive("gameButton",function(){return{restrict:"E",templateUrl:"./app/templates/game-button-template.html"}})}.call(this),function(){angular.module("footballAPI").directive("gameScore",["PlayerScore",function(PlayerScore){return{restrict:"E",templateUrl:"./app/templates/game-score-template.html",controller:function(){return this.playerScore=PlayerScore.currentPlayerScore,this},controllerAs:"gameScoreCtrl"}}])}.call(this),function(){angular.module("footballAPI").directive("gameGraph",function(){return{restrict:"E",templateUrl:"./app/templates/graph-template.html",controller:"GraphController",controllerAs:"graphCtrl"}})}.call(this),function(){angular.module("footballAPI").directive("appToolbar",function(){return{restrict:"E",replace:!0,templateUrl:"./app/templates/header-template.html",controller:"HeaderController",controllerAs:"headerCtrl"}})}.call(this),function(){angular.module("footballAPI").directive("gameMatches",function(){return{restrict:"E",replace:!0,templateUrl:"./app/templates/matches-template.html"}})}.call(this),function(){angular.module("footballAPI").directive("rulesTabContent",function(){return{restrict:"E",replace:!1,templateUrl:"./app/templates/rules-tab-content-template.html",controller:"RulesTabContentController",controllerAs:"rulesTabCtrl"}})}.call(this),function(){angular.module("footballAPI").factory("DataFormatter",["DATA","TIME",function(DATA,TIME){var addEventToGlobalEvents,dataFormatter,getCurrentResult,getEventTeam,getTime,isSecondHalf;return dataFormatter={},dataFormatter.processRawMatch=function(rawMatch){var formattedMatch;return formattedMatch={},formattedMatch.home_team=rawMatch.match_localteam_name,formattedMatch.away_team=rawMatch.match_visitorteam_name,formattedMatch.home_score=0,formattedMatch.away_score=0,formattedMatch.events=[],formattedMatch.currentResult=[DATA.DRAW],formattedMatch},dataFormatter.processLiveData=function(dataTime,formattedMatches,globalEvents,rawData){var awayScore,eventTime,formattedMatch,homeScore,i,j,k,l,m,matchTime,rawEvent,rawEvents,rawMatch,ref,ref1,ref2,ref3,ref4,ref5;for(i=k=0,ref=formattedMatches.length;ref>=0?ref>k:k>ref;i=ref>=0?++k:--k){for(rawMatch=rawData.matches[i],formattedMatch=formattedMatches[i],rawEvents=rawMatch.match_events,matchTime=getTime(rawMatch[DATA.MATCH_TIMER],rawMatch),j=l=ref1=formattedMatch.events.length,ref2=rawEvents.length;ref2>=ref1?ref2>l:l>ref2;j=ref2>=ref1?++l:--l)rawEvent=rawEvents[j],eventTime=getTime(parseInt(rawEvent[DATA.EVENT_TIME]),rawMatch),rawEvent[DATA.EVENT_TYPE]===DATA.EVENT_TYPE_GOAL&&(ref3=rawEvent[DATA.EVENT_RESULT].replace("[","").replace("]","").split(" - ").map(function(el){return parseInt(el)}),homeScore=ref3[0],awayScore=ref3[1],formattedMatch.home_score=homeScore,formattedMatch.away_score=awayScore,formattedMatch.currentResult[eventTime]=getCurrentResult(homeScore,awayScore)),rawEvent[DATA.EVENT_TEAM]=getEventTeam(rawEvent,formattedMatch.home_team,formattedMatch.away_team),formattedMatch.events.push(rawEvent),addEventToGlobalEvents(rawEvent,eventTime,globalEvents);for(j=m=ref4=dataTime+1,ref5=matchTime;ref5>=ref4?ref5>=m:m>=ref5;j=ref5>=ref4?++m:--m)formattedMatch.currentResult[j]||(formattedMatch.currentResult[j]=formattedMatch.currentResult[j-1])}return matchTime},dataFormatter.formatCurrentResults=function(time,matches){var k,len,match,results;for(results=[],k=0,len=matches.length;len>k;k++)match=matches[k],TIME.HALFTIME_START<=time&&time<=TIME.HALFTIME_END?results.push(match.currentResult[time]=match.currentResult[time-1]):results.push(void 0);
return results},getTime=function(rawTime,rawMatch){var offset;return rawMatch[DATA.MATCH_TIMER]===DATA.MATCH_TIMER_FINISHED?TIME.SECONDHALF_END:(offset=isSecondHalf(rawMatch)?TIME.SECONDHALF_START-TIME.FIRSTHALF_END:TIME.FIRSTHALF_START,parseInt(rawMatch[DATA.MATCH_TIMER])+offset)},isSecondHalf=function(rawMatch){var haveReachedHalfTime,isntHalfTime;return haveReachedHalfTime=rawMatch[DATA.HT_SCORE]!==DATA.HT_SCORE_NOT_REACHED,isntHalfTime=rawMatch[DATA.MATCH_STATUS]!==DATA.MATCH_STATUS_HT,haveReachedHalfTime&&isntHalfTime},getCurrentResult=function(homeScore,awayScore){var actual,scoreDiff;return scoreDiff=homeScore-awayScore,actual=scoreDiff>0?DATA.HOME_WIN:0>scoreDiff?DATA.AWAY_WIN:DATA.DRAW},getEventTeam=function(rawEvent,homeTeam,awayTeam){return rawEvent[DATA.EVENT_TEAM]===DATA.HOME_TEAM?homeTeam:awayTeam},addEventToGlobalEvents=function(rawEvent,matchTime,globalEvents){return globalEvents[matchTime]?globalEvents[matchTime].push(rawEvent):globalEvents[matchTime]=[rawEvent]},dataFormatter}])}.call(this),function(){angular.module("footballAPI").factory("Data",["DataFormatter","$http","$interval","$q","$timeout","TIME","URL",function(DataFormatter,$http,$interval,$q,$timeout,TIME,URL){var dataService,executeAndNewInterval,stopFetching;return dataService={},dataService.time=TIME.INITIAL_TIME,dataService.matches=[],dataService.globalEvents=[],dataService.initialise=function(){return $q(function(resolve,reject){return $http.get(URL.GET_INITIAL_MATCH_INFO).success(function(data,status){var i,len,match;for(i=0,len=data.length;len>i;i++)match=data[i],dataService.matches.push(DataFormatter.processRawMatch(match));return resolve()}).error(function(data,status){return reject()})})},dataService.startMatch=function(matchSpeed){var lengthOfSimulatedMinute,startSimulationURL;return lengthOfSimulatedMinute=TIME.SIXTY_SECONDS/matchSpeed,startSimulationURL=""+URL.START_SIMULATON_PREFIX+matchSpeed,$q(function(resolve,reject){return $http.get(startSimulationURL).success(function(data,status){var getSimulationUpdateURL,intervalId,tokenId;return tokenId=data.tokenId,getSimulationUpdateURL=""+URL.GET_SIMULATON_UPDATE_PREFIX+tokenId,intervalId=executeAndNewInterval(lengthOfSimulatedMinute,function(){return $http.get(getSimulationUpdateURL).success(function(data,status){return dataService.time=DataFormatter.processLiveData(dataService.time,dataService.matches,dataService.globalEvents,data),resolve(),dataService.time>=TIME.SECONDHALF_END?stopFetching(intervalId):void 0}).error(function(data,status){return stopFetching(intervalId),reject()})})}).error(function(data,status){return reject()})})},dataService.formatCurrentResults=function(time){return DataFormatter.formatCurrentResults(time,dataService.matches)},executeAndNewInterval=function(interval,callback){return callback(),$interval(callback,interval)},stopFetching=function(intervalId){return $interval.cancel(intervalId)},dataService}])}.call(this),function(){angular.module("footballAPI").factory("GlobalEvents",["Data","DATA","TIME",function(Data,DATA,TIME){var eventsService,initaliseGlobalEvents;return eventsService={},eventsService.globalEvents=[],eventsService.eventTooltips={list:function(){var i,ref,ref1,results;for(results=[],i=ref=TIME.FIRSTHALF_START,ref1=TIME.SECONDHALF_END;ref1>=ref?ref1>=i:i>=ref1;ref1>=ref?i++:i--)results.push(null);return results}()},eventsService.initialise=function(){return initaliseGlobalEvents()},eventsService.addEventTooltip=function(time){var event,eventString,eventTooltipString,i,len,ref;if(eventsService.globalEvents[time]){for(eventTooltipString="",ref=eventsService.globalEvents[time],i=0,len=ref.length;len>i;i++)event=ref[i],eventString="",event[DATA.EVENT_TYPE]===DATA.EVENT_TYPE_GOAL&&(eventString="-"+event[DATA.EVENT_PLAYER]+" ("+event[DATA.EVENT_TEAM]+")- "),eventTooltipString+=eventString;return eventsService.eventTooltips.list[time]=eventTooltipString}},initaliseGlobalEvents=function(){return eventsService.globalEvents=Data.globalEvents},eventsService}])}.call(this),function(){angular.module("footballAPI").factory("Graph",["Labels","PlayerScore",function(Labels,PlayerScore){var graphService;return graphService={},graphService.data=[],graphService.labels=Labels.graphLabels,graphService.initialise=function(){return graphService.data.push(PlayerScore.playerScore)},graphService}])}.call(this),function(){angular.module("footballAPI").factory("Labels",["GRAPH","TIME",function(GRAPH,TIME){var i,j,k,l,labelService,m,n,o,p,ref,ref1,ref10,ref11,ref12,ref13,ref14,ref15,ref16,ref2,ref3,ref4,ref5,ref6,ref7,ref8,ref9;for(labelService={},labelService.graphLabels=[],i=j=ref=TIME.FIRSTHALF_START,ref1=TIME.SECONDHALF_END;ref1>=ref?ref1>=j:j>=ref1;i=ref1>=ref?++j:--j)labelService.graphLabels.push("");for(i=k=ref2=TIME.FIRSTHALF_START,ref3=TIME.FIRSTHALF_END-1,ref4=GRAPH.LABEL_GAP;ref4>0?ref3>=k:k>=ref3;i=k+=ref4)labelService.graphLabels[i]=i+" FH";for(i=l=ref5=TIME.HALFTIME_START,ref6=TIME.HALFTIME_END,ref7=GRAPH.LABEL_GAP;ref7>0?ref6>=l:l>=ref6;i=l+=ref7)labelService.graphLabels[i]=i-TIME.HALFTIME_START+" HT";for(i=m=ref8=TIME.SECONDHALF_START,ref9=TIME.SECONDHALF_END,ref10=GRAPH.LABEL_GAP;ref10>0?ref9>=m:m>=ref9;i=m+=ref10)labelService.graphLabels[i]=i-(TIME.SECONDHALF_START-TIME.FIRSTHALF_END)+" SH";for(labelService.tooltipLabels=[],i=n=ref11=TIME.FIRSTHALF_START,ref12=TIME.FIRSTHALF_END;ref12>=n;i=n+=1)labelService.tooltipLabels[i]=i+" FH";for(i=o=ref13=TIME.HALFTIME_START,ref14=TIME.HALFTIME_END;ref14>=o;i=o+=1)labelService.tooltipLabels[i]=i-TIME.HALFTIME_START+" HT";for(i=p=ref15=TIME.SECONDHALF_START,ref16=TIME.SECONDHALF_END;ref16>=p;i=p+=1)labelService.tooltipLabels[i]=i-(TIME.SECONDHALF_START-TIME.FIRSTHALF_END)+" SH";return labelService}])}.call(this),function(){angular.module("footballAPI").factory("PlayerScore",["Data","Prediction","TIME",function(Data,Prediction,TIME){var playerScoreService;return playerScoreService={},playerScoreService.playerScore=[],playerScoreService.currentPlayerScore={},playerScoreService.currentPlayerScore.value=0,playerScoreService.initialise=function(){return playerScoreService.playerScore=function(){var j,ref,ref1,results;for(results=[],j=ref=TIME.FIRSTHALF_START,ref1=TIME.SECONDHALF_END;ref1>=ref?ref1>=j:j>=ref1;ref1>=ref?j++:j--)results.push(0);return results}()},playerScoreService.calculatePlayerScore=function(time){var finalNumberOfPredictions,i,j,match,numberOfMatches,prediction,predictionWasCorrect,ref,scoreForMatch,totalScore;for(totalScore=0,numberOfMatches=Data.matches.length,finalNumberOfPredictions=TIME.SECONDHALF_END+1,i=j=0,ref=numberOfMatches;ref>=0?ref>j:j>ref;i=ref>=0?++j:--j)prediction=Prediction.predictions[i],match=Data.matches[i],predictionWasCorrect=prediction.list[time]===match.currentResult[time],scoreForMatch=finalNumberOfPredictions-prediction.lastChange,scoreForMatch/=finalNumberOfPredictions,totalScore+=scoreForMatch*predictionWasCorrect*100;return playerScoreService.playerScore[time]=totalScore/numberOfMatches,playerScoreService.currentPlayerScore.value=playerScoreService.playerScore[time]},playerScoreService}])}.call(this),function(){angular.module("footballAPI").factory("Prediction",["Data","DATA","TIME",function(Data,DATA,TIME){var addPredictionTooltip,initialisePredictionTooltips,initialisePredictions,predictionService;return predictionService={},predictionService.predictions=[],predictionService.predictionTooltips={list:function(){var j,ref,ref1,results;for(results=[],j=ref=TIME.FIRSTHALF_START,ref1=TIME.SECONDHALF_END;ref1>=ref?ref1>=j:j>=ref1;ref1>=ref?j++:j--)results.push(null);return results}()},predictionService.initialise=function(){var numberOfMatches;return numberOfMatches=Data.matches.length,initialisePredictions(numberOfMatches),initialisePredictionTooltips(numberOfMatches)},predictionService.changePrediction=function(prediction,homeTeam,awayTeam,time,matchIndex){return predictionService.predictions[matchIndex].current=prediction,predictionService.predictions[matchIndex].lastChange=time,addPredictionTooltip(homeTeam,awayTeam,time,matchIndex)},predictionService.recordPrediction=function(time){var j,len,prediction,ref,results;for(ref=predictionService.predictions,results=[],j=0,len=ref.length;len>j;j++)prediction=ref[j],results.push(prediction.list[time]=angular.copy(prediction.current));return results},initialisePredictions=function(numberOfMatches){var i,j,ref,results;for(results=[],i=j=0,ref=numberOfMatches;ref>=0?ref>j:j>ref;i=ref>=0?++j:--j)results.push(predictionService.predictions.push({current:DATA.DRAW,lastChange:TIME.FIRSTHALF_START,list:[DATA.DRAW]}));return results},initialisePredictionTooltips=function(numberOfMatches){return predictionService.predictionTooltips.mostRecent=function(){var j,ref,results;for(results=[],j=0,ref=numberOfMatches;ref>=0?ref>j:j>ref;ref>=0?j++:j--)results.push(null);return results}()},addPredictionTooltip=function(homeTeam,awayTeam,time,matchIndex){var i,j,predictionTooltipString,ref;if(predictionTooltipString="-"+homeTeam+" v "+awayTeam+" : "+predictionService.predictions[matchIndex].current+"- ",predictionService.predictionTooltips.mostRecent[matchIndex]=predictionTooltipString,null===predictionService.predictionTooltips.list[time])return predictionService.predictionTooltips.list[time]=predictionTooltipString;for(predictionTooltipString="",i=j=0,ref=predictionService.predictions.length;ref>=0?ref>j:j>ref;i=ref>=0?++j:--j)predictionService.predictions[i].lastChange===time&&(predictionTooltipString+=predictionService.predictionTooltips.mostRecent[i]);return predictionService.predictionTooltips.list[time]=predictionTooltipString},predictionService}])}.call(this);